{"id":"bd-1kl","title":"Yocto 레시피 npmsw 오프라인 빌드 전환","description":"zigbee2mqtt bb 레시피를 오프라인 first 방식으로 전환\n- npm ci → inherit npm + npmsw:// 방식\n- devtool add로 npm-shrinkwrap.json 생성\n- 모든 의존성 라이센스 체크섬 포함\n- systemd 서비스 분리 (bbappend)\n- 참고 구현: domotik-or/yocto-domotik (2.4.0)\n- 정책 문서: docs/YOCTO-OFFLINE-FIRST.md","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-05T03:17:28.337897403Z","created_by":"junghan","updated_at":"2026-02-05T03:17:28.337897403Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-21k","title":"Yocto 빌드 환경 구축","description":"RPi5 타겟 Yocto 빌드 환경 구축\n- meta-raspberrypi 설정\n- meta-flutter (Sony) 통합\n- meta-hailo NPU 지원\n- Wayland/Weston 설정","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T08:41:12.535369231Z","created_by":"junghan","updated_at":"2026-02-04T09:29:10.224972400Z","closed_at":"2026-02-04T09:29:10.224952201Z","close_reason":"RPi5 Yocto scarthgap 빌드 완료. Weston 동작 확인, SSH 접속, meta-homeagent 레이어 (ssh-keys, shell-config, zigbee2mqtt)","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":1,"issue_id":"bd-21k","author":"junghan","text":"## 진행 상황 (2026-02-03)\n\n### 완료\n- [x] Yocto 레이어 클론 완료 (scarthgap 브랜치)\n  - poky, meta-openembedded, meta-raspberrypi, meta-clang\n- [x] flake.nix FHS 환경 구성\n  - buildFHSEnv 사용하여 Yocto HOSTTOOLS 제공\n  - lz4c 래퍼 스크립트 추가 (Yocto 요구사항)\n- [x] bitbake-layers show-layers 성공\n\n### 레이어 구성\n```\ncore, yocto, yoctobsp     (poky)\nopenembedded-layer        (meta-oe)\nmeta-python, networking   (meta-openembedded)\nraspberrypi               (meta-raspberrypi)\nclang-layer               (meta-clang)\n```\n\n### 다음 작업\n1. `bitbake core-image-weston` 빌드 실행 (수 시간 소요)\n2. SD 카드 플래싱 및 RPi5 부팅 테스트\n3. Wayland/Weston 동작 확인\n\n### 실행 방법\n```bash\n# FHS 환경 진입\nnix run  # 또는 ./result/bin/homeagent-yocto\n\n# Yocto 빌드\ncd yocto\nsource sources/poky/oe-init-build-env build\nbitbake core-image-weston\n```\n","created_at":"2026-02-03T10:08:27Z"}]}
{"id":"bd-21o","title":"Go Core 설정 (kd-wallpad-app 재사용)","description":"kd-wallpad-app의 Go Core 코드 재사용\n- HA API 호환 레이어\n- EdgeAI Runtime (ONNX/TFLite)\n- Flutter FFI Bridge\n- 컨텍스트 엔진","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-03T08:41:17.018072784Z","created_by":"junghan","updated_at":"2026-02-03T08:41:17.018072784Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2a0","title":"Flutter eLinux 빌드 검증","description":"meta-flutter로 Yocto에서 Flutter 앱 빌드\n- Sony meta-flutter 설정\n- Wayland 네이티브 검증\n- Go/Zig FFI 바인딩 테스트","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-03T08:41:25.961269531Z","created_by":"junghan","updated_at":"2026-02-03T08:41:25.961269531Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2wc","title":"Hailo-8 M.2 NPU 지원","description":"Edge AI 하드웨어 지원\n- meta-hailo 레이어 설정\n- ONNX Runtime 통합\n- 소프트센서 모델 배포","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-03T08:41:34.141863548Z","created_by":"junghan","updated_at":"2026-02-04T03:01:01.233390533Z","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":2,"issue_id":"bd-2wc","author":"junghan","text":"## Hailo 레이어 추가 (2026-02-04)\n\n### meta-hailo 발견!\n- GitHub: https://github.com/hailo-ai/meta-hailo\n- 브랜치: `hailo8-scarthgap` (scarthgap 호환 ✅)\n- **deb → recipe 변환 불필요!**\n\n### 제공 레이어\n| 레이어 | 내용 | 버전 |\n|--------|------|------|\n| meta-hailo-accelerator | PCIe 드라이버, 펌웨어 | - |\n| meta-hailo-libhailort | HailoRT, pyHailoRT, GStreamer | 4.23.0 |\n| meta-hailo-tappas | TAPPAS 프레임워크 | 5.1.0 |\n\n### 함께 사용할 리포\n- **hailo-apps**: 20+ AI 앱 (Detection, Pose, LLM, VLM, Voice Assistant)\n- **hailo-rpi5-examples**: RPi5 전용 예제\n\n### 다음 작업\n1. setup-layers.sh에 meta-hailo 추가 ✅\n2. bblayers.conf.sample 업데이트 ✅\n3. `bitbake core-image-weston` 빌드 (Hailo 포함)\n","created_at":"2026-02-04T03:01:01Z"}]}
{"id":"bd-34t","title":"Matter/Thread 통합","description":"Matter/Thread 통합 - OTBR + chip-tool 검증\n\n## 완료\n- [x] OTBR(ot-br-posix) v0.3.0 + avahi-daemon\n- [x] Thread RCP 동글 (/dev/ttyUSB, CP2102N, v2.5.3)\n- [x] otbr-agent 설정 (ttyUSB0, baudrate=460800)\n- [x] Thread 네트워크 형성 (leader, ch14, OpenThread-1667)\n- [x] chip-tool 크로스 컴파일 (Docker, 1m38s, 113MB)\n- [x] chip-tool RPi5 배포 (/opt/chip-tool/)\n\n## 블로커: glib2 버전 불일치\n- chip-tool 빌드: glib 2.80.0 (Docker ubuntu 24.04)\n- RPi5 Yocto: glib 2.78.6\n- 에러: undefined symbol: g_once_init_enter_pointer (glib 2.80+)\n- Fabric 생성, Thread dataset 설정까지는 성공 → BLE 초기화에서 크래시\n\n### 해결 방안\n1. **glib 번들 배포** — Docker sysroot에서 aarch64 glib .so 추출, LD_LIBRARY_PATH로 로드\n   - 경동 프로젝트에서 동일 패턴 사용 (chip-tool-android-bundle, 28개 lib)\n   - run-chip-tool.sh: `lib/ld-linux-aarch64.so.1 --library-path lib chip-tool`\n2. **Yocto glib 업그레이드** — meta-openembedded의 glib 2.80+ 레시피 확인\n   - scarthgap 5.0 기본 glib = 2.78, 업그레이드 가능성 검토\n3. **Docker 빌드 이미지 변경** — glib 2.78 기준으로 빌드 (older SDK tag)\n4. **정적 링크 빌드** — chip-tool을 static link로 빌드 (gn args 변경)\n\n### 참고: 경동 프로젝트 번들 구조\n- ~/repos/work/kyungdong-rockchip/matter/bin/\n- chip-tool-android-bundle.tar.gz (32MB)\n- lib/ld-linux-aarch64.so.1 + 28개 공유 라이브러리\n- run-chip-tool.sh wrapper로 LD 경로 지정\n\n## 다음 (glib 해결 후)\n- [ ] Matter 도어센서 commissioning (Eve, code: 0073-043-4300)\n- [ ] cluster read (contact sensor state)\n- [ ] OTBR 설정 Yocto bbappend\n\n## 전략 확정\n- python-matter-server + matterbridge 그대로 Yocto 패키징 (Go 재구현 안함)\n- chip-tool은 테스트 도구, production은 python-matter-server","status":"in_progress","priority":1,"issue_type":"task","created_at":"2026-02-03T08:41:30.154501085Z","created_by":"junghan","updated_at":"2026-02-05T08:03:25.246675938Z","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":3,"issue_id":"bd-34t","author":"junghan","text":"glib 해결: v1.4.0.0 + Docker tag 81 (ubuntu-22.04 sysroot, glib 2.72) 재빌드 진행 중. Yocto glib 2.78 호환 확인됨.","created_at":"2026-02-05T06:39:42Z"},{"id":4,"issue_id":"bd-34t","author":"junghan","text":"## glib 호환성 이슈 해결 완료 (2026-02-05)\n\n### 문제 1: g_once_init_enter_pointer (glib 2.80)\n- 증상: chip-tool pairing 시 BLE 초기화에서 크래시\n- 에러: undefined symbol: g_once_init_enter_pointer\n- 원인: v1.5.0.1 Docker tag 177 = ubuntu-24.04 sysroot (glib 2.80), Yocto scarthgap = glib 2.78\n- 해결: v1.4.0.0 + Docker tag 81 (ubuntu-22.04 sysroot, glib 2.72)\n\n### 문제 2: libatomic.so.1 누락\n- 증상: chip-tool 실행 시 error while loading shared libraries: libatomic.so.1\n- 원인: Yocto rootfs에 libatomic 미포함\n- 해결: Docker sysroot에서 libatomic.so.1 추출 → matter/bin/lib/ 번들 → LD_LIBRARY_PATH wrapper\n\n### 버전 호환 테이블\n| SDK | Docker tag | sysroot | glib | Yocto 호환 |\n|-----|-----------|---------|------|-----------|\n| v1.5.0.1 | 177 | ubuntu-24.04-aarch64 | 2.80 | X |\n| v1.4.0.0 | 81 | ubuntu-22.04.1-aarch64 | 2.72 | O |","created_at":"2026-02-05T07:19:30Z"},{"id":5,"issue_id":"bd-34t","author":"junghan","text":"## CASE operational discovery 실패 분석 (2026-02-05)\n\n### 진행 상황\n- chip-tool v1.4.0.0 + tag 81: glib/libatomic 해결 완료\n- BLE → PASE → NOC → Thread 조인: 모두 성공\n- CASE operational discovery: 타임아웃 (센서 SRP 미등록)\n\n### 원인\n1. OTBR backbone interface eth0→eth1 수정 (eth0 DOWN이었음)\n2. border routing=running, SRP server=running 확인\n3. 센서 Thread 조인 확인 (neighbor table에 child 3개)\n4. 그러나 SRP 서비스 등록 비어있음 → mDNS publish 안됨\n5. avahi-browse 미설치로 mDNS 디버깅 불가\n\n### 경동 참고\n- 경동에서도 Linux chip-tool CLI로 commissioning 실패 (PASE 타임아웃)\n- Android 네이티브 앱으로만 성공\n- SRP→mDNS→NsdManager 체인 동작 확인\n\n### 다음 단계\n1. avahi-utils 설치 → mDNS 상태 디버깅\n2. OTBR advertising proxy 동작 확인\n3. CommissioningComplete 전 CASE 타임아웃 문제 해결","created_at":"2026-02-05T07:56:31Z"},{"id":6,"issue_id":"bd-34t","author":"junghan","text":"## 크로스 프로젝트 분석: homeagent vs 경동 (2026-02-05)\n\n### 현재 위치: 진단 흐름 4번(SRP)에서 막힘\n1. SDK 호환성 ✅ (v1.4.0.0 + tag 81)\n2. BLE commissioning ✅ (Linux BlueZ 정상)\n3. Thread 조인 ✅ (child table 확인)\n4. SRP 등록 ❌ ← 여기서 막힘\n5. mDNS publish ❌ (avahi-utils 미설치로 디버깅 불가)\n6. CASE discovery ❌ (타임아웃)\n\n### 경동은 6번까지 성공\n- Android NsdManager 체인으로 mDNS 해결\n- SRP server enable 수동 필요했음\n- 네이티브 APK 필수 (proot chip-tool 한계)\n\n### 핵심 차이\n- homeagent: Linux BlueZ로 BLE OK, CASE에서 막힘\n- 경동: BLE 자체가 네이티브 필수, CASE는 APK로 해결\n\n### 다음: avahi-utils → mDNS advertising proxy 디버깅","created_at":"2026-02-05T08:03:25Z"}]}
{"id":"bd-356","title":"ZBDongle-E Thread RCP 펌웨어 플래시 스크립트","description":"ZBDongle-E를 Thread RCP 펌웨어로 전환하는 스크립트 작성\n\n## 참고\n- 원본: ~/repos/work/kyungdong-rockchip/demo/thread-rcp/flash-zbdongle-e.sh\n- 펌웨어: ot-rcp-v2.4.5.0-zbdonglee-460800.gbl (darkxst/silabs-firmware-builder)\n- EFR32MG21 Gecko Bootloader + Xmodem 전송\n\n## 작업\n1. scripts/flash-thread-rcp.sh 작성 (NixOS 호환, apt 제거)\n2. 펌웨어 다운로드 + 검증\n3. 부트로더 진입 가이드\n4. 수동/자동 플래시 옵션\n5. 플래시 후 /dev/ttyACM0 확인\n\n## 선행: bd-34t (Matter/Thread 통합)\nOTBR 동작에 Thread RCP 동글 필수","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T04:45:52.035305897Z","created_by":"junghan","updated_at":"2026-02-05T04:52:20.343756710Z","closed_at":"2026-02-05T04:52:20.343735950Z","close_reason":"scripts/flash-thread-rcp.sh 작성 완료 - NixOS 호환, 수동 minicom 방식","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-cuj","title":"zigbee2mqtt 2.8.0 업그레이드 검증","description":"1.42.0 → 2.8.0 메이저 업그레이드 검증\n- Node.js 20.15+ 필요 (18 지원 제거됨)\n- configuration.yaml 자동 마이그레이션 확인\n- pnpm 전환 (npm registry 발행은 유지)\n- HA Autodiscovery 호환성 (HA 2024.9+ 필수)\n- EmberZNet adapter discovery 설정 변경\n- 참고: https://github.com/Koenkk/zigbee2mqtt/discussions/24198","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-05T03:17:24.346414732Z","created_by":"junghan","updated_at":"2026-02-05T03:17:24.346414732Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-f36","title":"zigbee2mqtt + ZBDongle-E 검증","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T09:45:21.355403127Z","created_by":"junghan","updated_at":"2026-02-05T03:18:07.549161181Z","closed_at":"2026-02-05T03:18:07.549145240Z","close_reason":"zigbee2mqtt 1.42.0 + ZBDongle-E(ember) + Tuya TS0201 온습도센서 페어링 검증 완료. HA Autodiscovery 정상 동작.","source_repo":".","compaction_level":0,"original_size":0,"labels":["task"]}
{"id":"bd-o2i","title":"Zig Core 템플릿화 (sks-hub-zig)","description":"sks-hub-zig 코드 템플릿화\n- 상태머신 패턴 추출\n- Matter SDK 바인딩 조사\n- OTBR 통합 계획\n- FFI Layer 설계","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-03T08:41:21.581161173Z","created_by":"junghan","updated_at":"2026-02-03T08:41:21.581161173Z","source_repo":".","compaction_level":0,"original_size":0}
